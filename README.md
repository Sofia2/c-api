# Sofia2 C API

## Copyright notice

Â© 2013-15 Indra Sistemas S.A., Carlo Gavazzi Automation S.p.A., Circutor S.A.

Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.

Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.

## Repository contents

This repository contains the following directories:

* [docs](docs): this directory contains the C API documentation, generated with doxygen.
* [paho-mqtt-c](paho-mqtt-c): this directory contains the Eclipse Paho C MQTT client library.
* [cjson](cjson): this directory contains a library to manipulate JSON objects from C code. You should use it to manipulate the SSAP messages generated by the API.
* [ssap](ssap): this directory contains the SSAP C API itself.
* [Windows Build](Windows Build): this directory contains a Microsoft Visual Studio 2013 solution that builds the SSAP API DLL files and the examples.
* [examples](examples): this directory contains usage examples of the whole API. These examples are also integrated in the examples section of the API documentation.

We encourage you to read the documentation and examine the examples before using this API. If you have any problems or questions, please feel free to contact us at [plataformasofia2@indra.es](mailto:plataformasofia2@indra.es) or at [www.sofia2.com](www.sofia2.com).

## Sofia2 Concepts

Before using the SSAP API for the first time, we strongly recommend that you learn the main concepts of the Sofia2 platform. They have been included in the Sofia2 developer documentation, which can be downloaded from here.

## About the API usage examples

The folder [examples](examples) contains usage examples of the whole API. These examples are automatically compiled during the project build, and make use of the Sofia2 experimentation instance.

If you want to test this API, we encourage you to register here, to create your own ontologies and client applications and to modify the examples as much as you wish.

## Questions, enhancements, bug reporting

If you find any unexpected behavior while using this API, please feel free to contact us at plataformasofia2@indra.es.

You may also report bugs or suggest enhancements via pull request.

## Installation instructions

### Supported environments

The SSAP C API has been tested in the following environments:

* SuSE Linux, with i386 and AMD64 kernels, glibc 2.18+
* Ubuntu Linux 12.04 LTS, using i386 and AMD64 kernels.
* Ubuntu Linux 14.04 LTS, using i386 and AMD64 kernels.
* Debian GNU/Linux 7, using ARM, i386 and AMD64 kernels.
* Microsoft Windows 7, both 32 and 64 bit versions, Cygwin 1.7.32, Visual Studio 12 2013.

This API relies solely on the GNU C library, the openSSL library and the POSIX standard, so it will work with other recent Linux distributions, UNIX-like operating systems and Windows (through Cygwin).

Last, but not least, the API project must be built using CMake, version 2.8 or higher on UNIX systems only.

## Linux installation instructions

### Prerequisites

Obviously, you'll need a working C development environment to use this API. You can use the command

```
sudo apt-get install build-essential under Ubuntu Linux or Debian, or
zypper install -t pattern devel_C_C++ under SuSE Linux.
```

You will also need to install CMake, version 2.8 or higher. You can use the following commands:

```
sudo apt-get install cmake under Ubuntu Linux or Debian, or
zypper install cmake under SuSE Linux.
```

Finally, you'll have to install the OpenSSL and libuuid header files. You can use the command

* `sudo apt-get install libssl-dev uuid-dev` under Ubuntu Linux or Debian, or
* `zypper install libopenssl-devel libuuid-devel` under SuSE Linux.


## IDE support

You can import the C project on an IDE that includes CMake Integration, like Eclipse CDT or Kdevelop 4. The configuration instructions can be found here.

The API package also includes a pre-generated Kdevelop 4 project in its root folder that can be used at your convenience.

## Windows installation instructions

### Prerequisites

In order to compile the SSAP API in Windows, you must have a working Visual Studio 2013 installation. If you don't, you can download Visual Studio Express 2013 from Microsoft's website.

You'll also have to install the following software at the default installation paths

* the latest version of Cygwin.
* the latest version of the Visual Studio C++ 2008 redistributable binaries.
* the latest version of the precompiled OpenSSL library. Tell the installation wizard to put the binaries in the OpenSSL bin directory.

### Warnings

* Download and install either 32 or 64 bit binaries: do not mix them up! In any case, we recommend you to stick to the 32 bit binaries.
* If you don't install the OpenSSL binaries in the default location or if you use the 64 bit versions, you'll have to change the paths of the OpenSSL include and bin directories at all the Visual Studio project configuration dialogs.


### Visual Studio configuration

After installing the required software, we recommend you to copy the extracted ssap folder to the root of a system drive (like `D:\`).

Finally, you'll just have to open the `Windows Build/SSAP.sln` file and you'll be ready to go!

Note If you create a new Visual Studio Project within the solution, don't forget to 
* add the ssap and cjson projects as its dependencies,
* disable the generation of precompiled headers, and
* add the preprocessor definition `_CRT_SECURE_NO_WARNINGS`.
